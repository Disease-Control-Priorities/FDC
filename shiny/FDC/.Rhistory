x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), "K"),
x < 1e9 ~ paste0(as.character(x/1e6), "M"),
)
} #end of function
all<-all%>%
mutate(`New CVD events` = so_formatter(`New CVD events`))
View(all)
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence (%)" = signif(100*(base_prev-`Prevalent CVD cases`)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all<-all%>%
mutate(`New CVD events` = so_formatter(`New CVD events`))
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence (%)" = signif(100*(base_prev-`Prevalent CVD cases`)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", \n", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all<-all%>%
mutate(`New CVD events` = so_formatter(`New CVD events`))
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence (%)" = signif(100*(base_prev-`Prevalent CVD cases`)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
HTML(paste0(Intervention,", \n", Scenario)),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all<-all%>%
mutate(`New CVD events` = so_formatter(`New CVD events`))
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence (%)" = signif(100*(base_prev-`Prevalent CVD cases`)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all<-all%>%
mutate(`New CVD events` = so_formatter(`New CVD events`))
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence" = signif(100*(`Prevalent CVD cases`-base_prev)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
View(all)
all[,c(3,4,5,7,8)]<-so_formatter(all[,c(3,4,5,7,8)])
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence" = signif(100*(`Prevalent CVD cases`-base_prev)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all[,c(3,4,5,7,8)]<-so_formatter(all[,c(3,4,5,7,8)])
all[,3]<-so_formatter(all[,3])
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence" = signif(100*(`Prevalent CVD cases`-base_prev)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all[1:2,6:8]<-NA
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all$`New CVD events`<-so_formatter(all$`New CVD events`)
View(all)
all$`CVD events averted`<-so_formatter(all$`CVD events averted`)
View(all)
all$`Prevalent CVD cases`<-so_formatter(all$`Prevalent CVD cases`)
all$`Change in CVD prevalence`<-paste0(all$`Change in CVD prevalence`, "%")
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence" = signif(100*(`Prevalent CVD cases`-base_prev)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all$`New CVD events`<-so_formatter(all$`New CVD events`)
all$`CVD events averted`<-so_formatter(all$`CVD events averted`)
all$`Prevalent CVD cases`<-so_formatter(all$`Prevalent CVD cases`)
all$`Change in CVD prevalence`<-paste0(all$`Change in CVD prevalence`, "%")
all$`CVD deaths`<-so_formatter(all$`CVD deaths`)
all$`Deaths averted`<-so_formatter(all$`Deaths averted`)
all[1:2,6:8]<-NA
View(all)
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = signif(base_deaths- `CVD deaths`, digits = 2),
"CVD events averted" = signif(base_inc - `New CVD events`, digits=2),
"Change in CVD prevalence" = signif(100*(`Prevalent CVD cases`-base_prev)/base_prev, digits=2),
`CVD deaths` = signif(`CVD deaths`, digits=2),
`New CVD events` = signif(`New CVD events`, digits=2),
`Prevalent CVD cases` = signif(`Prevalent CVD cases`, digits=2),
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all$`New CVD events`<-so_formatter(all$`New CVD events`)
all$`CVD events averted`<-so_formatter(all$`CVD events averted`)
all$`Prevalent CVD cases`<-so_formatter(all$`Prevalent CVD cases`)
all$`Change in CVD prevalence`<-paste0(all$`Change in CVD prevalence`, "%")
all$`CVD deaths`<-so_formatter(all$`CVD deaths`)
all$`Deaths averted`<-so_formatter(all$`Deaths averted`)
View(all)
View(all)
all[1:2,c(4,6,8)]<-NA
View(all)
table<-download%>%
filter(year==2050 & intervention!="Current care")%>%
bind_rows(., download%>%filter(year %in% c(2020,2050)
& intervention=="Current care"
& Scenario == "FDC with aspirin"))%>%
group_by(location, year, intervention, Scenario)%>%
summarise(deaths = sum(CVD_deaths),
events = sum(Incidence),
prev = sum(Prevalent_CVD))
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = base_deaths- `CVD deaths`,
"CVD events averted" = base_inc - `New CVD events`,
"Change in CVD prevalence" = 100*(`Prevalent CVD cases`-base_prev)/base_prev,
`CVD deaths` = `CVD deaths`,
`New CVD events` = `New CVD events`,
`Prevalent CVD cases` = `Prevalent CVD cases`,
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
View(all)
#reorder and clean up
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all$`New CVD events`<-so_formatter(signif(all$`New CVD events`, digits=2))
all$`CVD events averted`<-so_formatter(signif(all$`CVD events averted`, digits=2))
all$`Prevalent CVD cases`<-so_formatter(signif(all$`Prevalent CVD cases`, digits=2))
all$`Change in CVD prevalence`<-paste0(signif(all$`Change in CVD prevalence`, digits=2), "%")
all$`CVD deaths`<-so_formatter(signif(all$`CVD deaths`, digits=2))
all$`Deaths averted`<-so_formatter(signif(all$`Deaths averted`, digits=2))
all[1:2,c(4,6,8)]<-NA
View(all)
runApp()
runApp()
table<-download%>%filter(location=="Brazil")%>%
filter(year==2050 & intervention!="Current care")%>%
bind_rows(., download%>%filter(year %in% c(2020,2050)
& intervention=="Current care"
& Scenario == "FDC with aspirin"))%>%
group_by(location, year, intervention, Scenario)%>%
summarise(deaths = sum(CVD_deaths),
events = sum(Incidence),
prev = sum(Prevalent_CVD))
all<-table%>%
group_by(year, intervention, Scenario)%>%
summarise("CVD deaths" = sum(deaths),
"New CVD events"  = sum(events),
"Prevalent CVD cases" = sum(prev))%>%
rename(Intervention = intervention,
Year = year)
base_deaths<-as.numeric(all[2,4])
base_inc<-as.numeric(all[2,5])
base_prev<-as.numeric(all[2,6])
all<-all%>%
mutate("Deaths averted" = base_deaths- `CVD deaths`,
"CVD events averted" = base_inc - `New CVD events`,
"Change in CVD prevalence" = 100*(`Prevalent CVD cases`-base_prev)/base_prev,
`CVD deaths` = `CVD deaths`,
`New CVD events` = `New CVD events`,
`Prevalent CVD cases` = `Prevalent CVD cases`,
Intervention = ifelse(Intervention!="Current care",
paste0(Intervention,", ", Scenario),
Intervention)
)%>%
select(-Scenario)%>%
rename(Scenario = Intervention)
#reorder and clean up
all<-all[,c(1,2,4,7,5,8,3,6)]
all<-all[c(1,2,4,3,6,5,8,7,10,9),]
#significant digit formatter function
so_formatter <- function(x) {
dplyr::case_when(
x < 1e3 ~ as.character(x),
x < 1e6 ~ paste0(as.character(x/1e3), " thousand"),
x < 1e9 ~ paste0(as.character(x/1e6), " million"),
)
} #end of function
all$`New CVD events`<-so_formatter(signif(all$`New CVD events`, digits=2))
all$`CVD events averted`<-so_formatter(signif(all$`CVD events averted`, digits=2))
all$`Prevalent CVD cases`<-so_formatter(signif(all$`Prevalent CVD cases`, digits=2))
all$`Change in CVD prevalence`<-paste0(signif(all$`Change in CVD prevalence`, digits=2), "%")
all$`CVD deaths`<-so_formatter(signif(all$`CVD deaths`, digits=2))
all$`Deaths averted`<-so_formatter(signif(all$`Deaths averted`, digits=2))
all[1:2,c(4,6,8)]<-NA
View(all)
View(download)
table<-download%>%filter(location=="Brazil")%>%
filter(year==2050 & intervention!="Current care")%>%
bind_rows(., download%>%filter(year %in% c(2020,2050)
& intervention=="Current care"
& Scenario == "FDC with aspirin"))%>%
group_by(location, year, intervention, Scenario)%>%
summarise(deaths = sum(CVD_deaths),
events = sum(Incidence),
prev = sum(Prevalent_CVD))
View(table)
table<-download%>%filter(location=="Brazil")%>%
filter(year==2050 & intervention!="Current care")%>%
bind_rows(., download%>%filter(year %in% c(2020,2050)
& intervention=="Current care"
& Scenario == "FDC with aspirin"))%>%
group_by(year, intervention, Scenario)%>%
summarise(deaths = sum(CVD_deaths),
events = sum(Incidence),
prev = sum(Prevalent_CVD))
View(table)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
#load data
df<-read.csv("for_download.csv", stringsAsFactors = F)
View(df)
runApp()
runApp()
runApp()
install.packages("highcharter")
runApp()
runApp()
runApp()
